{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\DeliveryApp\\\\src\\\\pages\\\\OrderTracking.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport { io } from 'socket.io-client';\nimport L from 'leaflet';\nimport axios from 'axios';\nimport 'leaflet/dist/leaflet.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png')\n});\nconst SOCKET_SERVER_URL = 'http://localhost:3001';\nconst OrderTracking = () => {\n  _s();\n  const {\n    orderId\n  } = useParams();\n  const navigate = useNavigate();\n  const [order, setOrder] = useState(null);\n  const [driverLocation, setDriverLocation] = useState(null);\n  const socketRef = useRef(null);\n  const driverId = localStorage.getItem('driverId');\n  const handleMarkDelivered = async () => {\n    try {\n      await axios.put(`http://localhost:3001/orders/mark-delivered/${orderId}`);\n      alert('Order marked as delivered!');\n      navigate('/driver-dashboard');\n    } catch (err) {\n      console.error('Failed to mark delivered:', err);\n    }\n  };\n  useEffect(() => {\n    axios.get(`http://localhost:3001/orders/${orderId}`).then(res => setOrder(res.data)).catch(() => console.error('Order fetch failed'));\n  }, [orderId]);\n  useEffect(() => {\n    socketRef.current = io(SOCKET_SERVER_URL);\n    socketRef.current.on(`orderLocationUpdate:${orderId}`, data => {\n      setDriverLocation([data.lat, data.lng]);\n    });\n    if (driverId) {\n      const watchId = navigator.geolocation.watchPosition(({\n        coords\n      }) => {\n        socketRef.current.emit('driverLocation', {\n          orderId,\n          lat: coords.latitude,\n          lng: coords.longitude\n        });\n      }, err => console.error(err), {\n        enableHighAccuracy: true,\n        timeout: 5000,\n        maximumAge: 3000\n      });\n      return () => navigator.geolocation.clearWatch(watchId);\n    }\n    return () => socketRef.current.disconnect();\n  }, [orderId, driverId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [33.89, 35.5],\n      zoom: 13,\n      style: styles.map,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), driverLocation && /*#__PURE__*/_jsxDEV(Marker, {\n        position: driverLocation,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: \"Driver is here!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), driverId && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleMarkDelivered,\n      style: styles.deliverButton,\n      children: \"Mark as Delivered\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n_s(OrderTracking, \"qiJUkrRbhirTsSGgSz1VKZbhTnk=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = OrderTracking;\nconst styles = {\n  container: {\n    minHeight: '100vh',\n    backgroundColor: '#f0f2f5',\n    fontFamily: 'Arial, sans-serif',\n    padding: '20px'\n  },\n  map: {\n    height: '400px',\n    width: '100%',\n    borderRadius: '5px',\n    marginBottom: '20px'\n  },\n  deliverButton: {\n    padding: '12px 20px',\n    backgroundColor: '#4CAF50',\n    color: 'white',\n    border: 'none',\n    borderRadius: '8px',\n    cursor: 'pointer',\n    fontSize: '16px'\n  }\n};\nexport default OrderTracking;\nvar _c;\n$RefreshReg$(_c, \"OrderTracking\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useNavigate","MapContainer","TileLayer","Marker","Popup","io","L","axios","jsxDEV","_jsxDEV","Icon","Default","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","SOCKET_SERVER_URL","OrderTracking","_s","orderId","navigate","order","setOrder","driverLocation","setDriverLocation","socketRef","driverId","localStorage","getItem","handleMarkDelivered","put","alert","err","console","error","get","then","res","data","catch","current","on","lat","lng","watchId","navigator","geolocation","watchPosition","coords","emit","latitude","longitude","enableHighAccuracy","timeout","maximumAge","clearWatch","disconnect","style","styles","container","children","center","zoom","map","url","fileName","_jsxFileName","lineNumber","columnNumber","position","onClick","deliverButton","_c","minHeight","backgroundColor","fontFamily","padding","height","width","borderRadius","marginBottom","color","border","cursor","fontSize","$RefreshReg$"],"sources":["C:/xampp/htdocs/DeliveryApp/src/pages/OrderTracking.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\r\nimport { io } from 'socket.io-client';\r\nimport L from 'leaflet';\r\nimport axios from 'axios';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\r\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\r\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\r\n});\r\n\r\nconst SOCKET_SERVER_URL = 'http://localhost:3001';\r\n\r\nconst OrderTracking = () => {\r\n  const { orderId } = useParams();\r\n  const navigate = useNavigate();\r\n  const [order, setOrder] = useState(null);\r\n  const [driverLocation, setDriverLocation] = useState(null);\r\n  const socketRef = useRef(null);\r\n  const driverId = localStorage.getItem('driverId');\r\n\r\n\r\n\r\n  \r\n\r\n  const handleMarkDelivered = async () => {\r\n    try {\r\n      await axios.put(`http://localhost:3001/orders/mark-delivered/${orderId}`);\r\n      alert('Order marked as delivered!');\r\n      navigate('/driver-dashboard');\r\n    } catch (err) {\r\n      console.error('Failed to mark delivered:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    axios.get(`http://localhost:3001/orders/${orderId}`)\r\n      .then(res => setOrder(res.data))\r\n      .catch(() => console.error('Order fetch failed'));\r\n  }, [orderId]);\r\n\r\n  useEffect(() => {\r\n    socketRef.current = io(SOCKET_SERVER_URL);\r\n\r\n    socketRef.current.on(`orderLocationUpdate:${orderId}`, data => {\r\n      setDriverLocation([data.lat, data.lng]);\r\n    });\r\n\r\n    if (driverId) {\r\n      const watchId = navigator.geolocation.watchPosition(\r\n        ({ coords }) => {\r\n          socketRef.current.emit('driverLocation', {\r\n            orderId,\r\n            lat: coords.latitude,\r\n            lng: coords.longitude\r\n          });\r\n        },\r\n        err => console.error(err),\r\n        { enableHighAccuracy: true, timeout: 5000, maximumAge: 3000 }\r\n      );\r\n      return () => navigator.geolocation.clearWatch(watchId);\r\n    }\r\n\r\n    return () => socketRef.current.disconnect();\r\n  }, [orderId, driverId]);\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      <MapContainer center={[33.89, 35.5]} zoom={13} style={styles.map}>\r\n        <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n        {driverLocation && (\r\n          <Marker position={driverLocation}>\r\n            <Popup>Driver is here!</Popup>\r\n          </Marker>\r\n        )}\r\n      </MapContainer>\r\n\r\n      {driverId && (\r\n        <button onClick={handleMarkDelivered} style={styles.deliverButton}>\r\n          Mark as Delivered\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    minHeight: '100vh',\r\n    backgroundColor: '#f0f2f5',\r\n    fontFamily: 'Arial, sans-serif',\r\n    padding: '20px'\r\n  },\r\n  map: {\r\n    height: '400px',\r\n    width: '100%',\r\n    borderRadius: '5px',\r\n    marginBottom: '20px'\r\n  },\r\n  deliverButton: {\r\n    padding: '12px 20px',\r\n    backgroundColor: '#4CAF50',\r\n    color: 'white',\r\n    border: 'none',\r\n    borderRadius: '8px',\r\n    cursor: 'pointer',\r\n    fontSize: '16px'\r\n  }\r\n};\r\n\r\nexport default OrderTracking;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}